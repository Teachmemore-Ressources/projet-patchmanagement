# Cahier des Charges ‚Äì Automatisation du Patch Management avec AWX et Ansible

## Introduction

Dans un environnement informatique en constante √©volution, la gestion des mises √† jour (patch management) est une composante essentielle de la s√©curit√© et de la stabilit√© des infrastructures IT. Un syst√®me non mis √† jour est une cible de choix pour les cyberattaques et peut √™tre source d‚Äôinstabilit√©, mettant en p√©ril la disponibilit√© des services et la conformit√© r√©glementaire.

Face √† cette probl√©matique, il devient imp√©ratif d‚Äôadopter une solution d‚Äôautomatisation robuste et centralis√©e pour garantir l‚Äôapplication r√©guli√®re et contr√¥l√©e des correctifs sur l‚Äôensemble des plateformes : serveurs Linux et Windows, √©quipements r√©seau, et infrastructures virtualis√©es (ESXi, OpenStack, Kubernetes, Proxmox).

Ce projet vise √† concevoir et d√©ployer une solution de gestion automatis√©e des correctifs, reposant sur AWX et Ansible, permettant d‚Äôorchestrer les mises √† jour de mani√®re s√©curis√©e, efficace et tra√ßable. L‚Äôobjectif est de proposer une architecture flexible et √©volutive, capable de s‚Äôint√©grer dans des environnements h√©t√©rog√®nes tout en r√©pondant aux exigences de s√©curit√© et de conformit√©.

## Conception et D√©ploiement de la Solution

L‚Äôarchitecture technique repose sur plusieurs composants interconnect√©s qui assureront une gestion centralis√©e des mises √† jour. AWX, qui est l‚Äôinterface web open-source pour Ansible, sera d√©ploy√© sur une instance Kubernetes Single Node, garantissant ainsi flexibilit√© et scalabilit√©. Cette instance facilitera l‚Äôex√©cution et la gestion des playbooks Ansible, scripts automatisant les t√¢ches de mise √† jour.

Le stockage des correctifs sera assur√© par un r√©f√©rentiel Linux capable d‚Äôh√©berger les mises √† jour n√©cessaires pour les syst√®mes Linux, Windows et les √©quipements r√©seau. Ce r√©f√©rentiel servira de d√©p√¥t centralis√©, √©vitant ainsi la d√©pendance √† des sources externes et garantissant une distribution rapide et contr√¥l√©e des correctifs.

Pour g√©rer et versionner les playbooks Ansible, un d√©p√¥t Git sera mis en place avec Gitea, une alternative l√©g√®re et auto-h√©berg√©e √† GitLab ou GitHub. Gitea facilitera la collaboration entre les administrateurs et assurera un suivi pr√©cis des modifications et des mises √† jour des scripts d‚Äôautomatisation. Il sera d√©ploy√© sur une machine virtuelle d√©di√©e, optimis√©e pour l‚Äôex√©cution de Docker, simplifiant ainsi son installation et sa maintenance.

L‚Äôun des d√©fis majeurs du projet r√©side dans la gestion de l‚Äôauthentification et des permissions. Pour garantir un acc√®s s√©curis√© aux serveurs Windows, AWX sera int√©gr√© √† Active Directory (AD), permettant ainsi une gestion centralis√©e des droits d‚Äôacc√®s et une authentification s√©curis√©e via les comptes existants. L‚Äôinventaire des machines et √©quipements √† mettre √† jour sera g√©r√© dynamiquement gr√¢ce aux modules d‚Äôinventaire dynamique d‚ÄôAnsible, permettant ainsi une d√©tection automatique des h√¥tes et un suivi en temps r√©el de leur √©tat.

## Infrastructure Technique et D√©ploiement

L‚Äôensemble de la solution sera d√©ploy√© dans un environnement virtualis√© bas√© sur Proxmox, garantissant un isolement optimal des composants et facilitant les tests avant un d√©ploiement en production. Chaque machine virtuelle aura un r√¥le bien d√©fini, optimisant ainsi la gestion des ressources et simplifiant les op√©rations de maintenance.

### Serveur AWX (Ansible Tower Open Source)
- **OS** : Ubuntu 22.04 LTS
- **CPU** : 8 vCPU
- **RAM** : 16 Go
- **Stockage** : 100 Go SSD
- **R√¥le** :
  - H√©bergement d‚ÄôAWX pour l‚Äôorchestration des mises √† jour
  - Ex√©cution des playbooks Ansible
  - Interface web pour la gestion et le monitoring des t√¢ches
  - Int√©gration avec Active Directory (authentification et gestion des droits)
- **D√©ploiement d‚ÄôAWX via Kubernetes Single Node** :
  - Kubernetes install√© avec kubeadm
  - Utilisation d‚Äôun Ingress Controller pour l‚Äôacc√®s web s√©curis√©
  - Base de donn√©es PostgreSQL 14 h√©berg√©e en local (VM)
  - AWX Operator pour le d√©ploiement et la gestion des mises √† jour

### Serveur Gitea (D√©p√¥t Git Auto-h√©berg√©)
- **OS** : Ubuntu 22.04 LTS
- **CPU** : 4 vCPU
- **RAM** : 8 Go
- **Stockage** : 200 Go SSD (stockage des playbooks et logs)
- **R√¥le** :
  - Gestion des playbooks Ansible
  - Versionnement des scripts et des fichiers de configuration
  - Int√©gration avec AWX pour une ex√©cution automatis√©e des t√¢ches
- **D√©ploiement de Gitea via Docker** :
  - Gitea ex√©cut√© dans un conteneur Docker
  - Base de donn√©es MariaDB ou PostgreSQL pour la persistance des donn√©es
  - Exposition via Nginx Reverse Proxy s√©curis√© avec Let‚Äôs Encrypt

### R√©f√©rentiel des Correctifs (Serveur Linux)
- **OS** : Debian 12
- **CPU** : 4 vCPU
- **RAM** : 16 Go
- **Stockage** : 2 To HDD (stockage des mises √† jour)
- **R√¥le** :
  - H√©bergement des patchs Linux, Windows, ESXi, √©quipements r√©seau (Cisco, Juniper, etc.)
  - Acc√®s via HTTP, FTP et SMB pour une distribution rapide
  - Synchronisation automatique avec les sources officielles et stockage des mises √† jour valid√©es
- **Configuration sp√©cifique** :
  - Serveur Apache/Nginx pour l‚Äôacc√®s web
  - Service Samba pour le d√©ploiement des correctifs Windows
  - Mirroring des d√©p√¥ts officiels (Ubuntu, CentOS, Windows Update Catalog)

### Contr√¥leur Active Directory (Authentification Windows)
- **OS** : Windows Server 2019
- **CPU** : 4 vCPU
- **RAM** : 8 Go
- **Stockage** : 100 Go SSD
- **R√¥le** :
  - Gestion des comptes et des groupes pour l‚Äôauthentification sur AWX
  - Centralisation des droits d‚Äôacc√®s pour les serveurs Windows
  - Int√©gration avec AWX via Kerberos/WinRM

### Serveurs de Test pour l‚ÄôApplication des Patches
Pour valider les mises √† jour avant leur d√©ploiement en production, des serveurs de test seront configur√©s :
- **Serveur Linux Test** : Ubuntu 22.04, 2 vCPU, 4 Go RAM, 40 Go SSD
- **Serveur Windows Test** : Windows Server 2019, 2 vCPU, 4 Go RAM, 60 Go SSD
- **√âquipement R√©seau Test** : GNS3 avec des images Cisco/Juniper pour tester les mises √† jour des firmwares

## Automatisation et Workflows d‚ÄôEx√©cution

L‚Äôautomatisation des mises √† jour s‚Äôappuiera sur des workflows sp√©cifiques pour chaque type de plateforme, garantissant ainsi une gestion optimis√©e et adapt√©e aux particularit√©s de chaque environnement.

### Mise √† Jour des Serveurs Linux
Les serveurs Linux seront mis √† jour via Ansible en utilisant les gestionnaires de paquets natifs (apt, dnf, yum). Le processus commencera par une d√©tection des mises √† jour disponibles, suivie d‚Äôune v√©rification des d√©pendances et d‚Äôun contr√¥le de compatibilit√©. Les correctifs seront ensuite appliqu√©s de mani√®re contr√¥l√©e, avec une option permettant de planifier les red√©marrages en fonction des contraintes de production.

### Mise √† Jour des Serveurs Windows
La gestion des correctifs Windows s‚Äôeffectuera via WinRM, permettant une ex√©cution distante s√©curis√©e. Apr√®s authentification via Active Directory, les mises √† jour seront t√©l√©charg√©es depuis le r√©f√©rentiel interne, puis appliqu√©es selon un calendrier d√©fini. Un m√©canisme de reporting assurera un suivi pr√©cis des mises √† jour install√©es et des √©ventuelles erreurs rencontr√©es.

### Mise √† Jour des √âquipements R√©seau
Les √©quipements r√©seau, tels que les routeurs et switches Cisco, n√©cessitent une approche diff√©rente. Une premi√®re phase consistera √† sauvegarder la configuration actuelle des √©quipements, afin de pouvoir effectuer un rollback en cas de probl√®me. Ensuite, les nouvelles images seront t√©l√©charg√©es et appliqu√©es, avec une v√©rification post-d√©ploiement garantissant le bon fonctionnement des √©quipements apr√®s la mise √† jour.

### Mise √† Jour des Plateformes Virtualis√©es (ESXi, OpenStack, Kubernetes, Proxmox)
L‚Äôapproche ici consistera √† utiliser les API de chaque plateforme pour orchestrer les mises √† jour de mani√®re non intrusive. Dans le cas d‚ÄôESXi, par exemple, les h√¥tes seront mis en mode maintenance avant l‚Äôapplication des correctifs, et un m√©canisme de test post-mise √† jour sera mis en place pour √©viter toute interruption de service.

## S√©curit√© et Contr√¥le d‚ÄôAcc√®s
L‚Äôaspect s√©curit√© sera primordial dans ce projet, en garantissant une gestion stricte des acc√®s et une tra√ßabilit√© compl√®te des actions effectu√©es. L‚Äôauthentification centralis√©e via Active Directory renforcera le contr√¥le d‚Äôacc√®s, et AWX permettra d‚Äôassigner des r√¥les sp√©cifiques aux administrateurs, limitant ainsi les privil√®ges √† ce qui est strictement n√©cessaire.

Les connexions SSH et WinRM seront s√©curis√©es avec une gestion rigoureuse des cl√©s et certificats. De plus, un syst√®me de sauvegarde automatique des configurations garantira une r√©cup√©ration rapide en cas d‚Äôincident.

## Pr√©sentation du Bootcamp

### Bootcamp Intensif : Automatisation du Patch Management sur Infrastructure Hybride
Ce programme intensif de trois mois s‚Äôadresse aux professionnels de l‚Äôinformatique souhaitant acqu√©rir une expertise approfondie dans l'automatisation du patch management sur des infrastructures h√©t√©rog√®nes. Il couvre l‚Äôensemble des processus n√©cessaires √† la gestion efficace des mises √† jour sur des environnements vari√©s comprenant des serveurs Linux et Windows, des √©quipements r√©seau ainsi que des plateformes cloud et de virtualisation telles que Kubernetes, OpenStack et Proxmox.

L‚Äôobjectif est d‚Äôapporter aux participants une m√©thodologie rigoureuse et des comp√©tences pratiques pour concevoir, d√©ployer et administrer une solution d‚Äôautomatisation bas√©e sur AWX (version open-source d‚ÄôAnsible Tower), Ansible et Gitea pour la gestion centralis√©e des configurations et des workflows d‚Äôautomatisation. Une attention particuli√®re sera port√©e √† l‚Äôint√©gration des r√©f√©rentiels de correctifs, √† l‚Äôinventaire dynamique et √† la supervision des op√©rations via des outils de monitoring et d‚Äôaudit.

√Ä l‚Äôissue de ce bootcamp, chaque participant sera en mesure de concevoir et mettre en place un environnement de gestion automatis√©e des mises √† jour, incluant :
- L‚Äôinstallation et la configuration compl√®te d‚Äôune infrastructure sur Proxmox en vue d‚Äôh√©berger les diff√©rents services n√©cessaires √† l‚Äôautomatisation du patch management.
- L‚Äôutilisation avanc√©e d‚ÄôAnsible et AWX pour orchestrer les mises √† jour des serveurs et √©quipements r√©seau, en tenant compte des meilleures pratiques en mati√®re de s√©curit√© et de fiabilit√©.
- La mise en place d‚Äôun r√©f√©rentiel Git (Gitea) afin de versionner et centraliser les playbooks Ansible, garantissant ainsi une gestion coh√©rente et auditable des configurations.
- Le d√©ploiement d‚Äôun r√©f√©rentiel centralis√© de correctifs pour stocker et distribuer les mises √† jour des syst√®mes Linux, Windows et des √©quipements r√©seau.
- L‚Äôimpl√©mentation de workflows automatis√©s couvrant divers environnements technologiques, qu‚Äôil s‚Äôagisse de serveurs classiques, d‚Äôinfrastructures cloud ou de plateformes de virtualisation comme Kubernetes et OpenStack.
- La supervision et la s√©curisation de l‚Äôensemble des op√©rations gr√¢ce √† des outils d‚Äôaudit et de monitoring permettant de garantir la conformit√© des mises √† jour et d‚Äôanticiper les √©ventuelles anomalies.

### Pr√©requis et Comp√©tences Requises
Afin de maximiser l‚Äôefficacit√© de la formation et garantir une progression fluide, il est recommand√© aux participants de poss√©der un certain niveau de connaissances dans les domaines suivants :

1. **Ma√Ætrise des syst√®mes d‚Äôexploitation**
Une exp√©rience pr√©alable avec Linux (Debian/Ubuntu, Red Hat/CentOS) est un atout majeur. La compr√©hension de la ligne de commande, la gestion des packages ainsi que la gestion des permissions et des services syst√®me sont essentielles pour naviguer efficacement dans l‚Äôenvironnement Unix. De m√™me, des notions de base sur Windows Server (versions 2016/2019), notamment sur Active Directory, WinRM et la gestion des mises √† jour via WSUS ou SCCM, permettront d‚Äôint√©grer les serveurs Windows dans le processus d‚Äôautomatisation.

2. **Compr√©hension des concepts r√©seaux et de la virtualisation**
Les participants doivent √™tre √† l‚Äôaise avec les notions fondamentales de TCP/IP, DNS, DHCP, VLAN et SSH, qui sont essentielles pour assurer la communication et l‚Äôadministration √† distance des machines cibles. Une premi√®re exp√©rience avec des hyperviseurs comme Proxmox, VMware ou VirtualBox/KVM est fortement conseill√©e, notamment pour la gestion des ressources virtuelles. Par ailleurs, une connaissance des √©quipements r√©seau Cisco, Juniper, Mikrotik ou Fortinet facilitera l‚Äôautomatisation des mises √† jour et la gestion des configurations.

3. **Notions de DevOps et d‚Äôautomatisation**
La ma√Ætrise des bases d‚ÄôAnsible est un atout important, notamment la compr√©hension des playbooks, r√¥les et modules. Une familiarit√© avec Git, GitHub ou GitLab est √©galement indispensable pour le stockage et la gestion du code d‚Äôautomatisation. De plus, des notions sur Docker et Kubernetes, en particulier la gestion des conteneurs et le d√©ploiement d‚Äôapplications, seront essentielles pour comprendre le fonctionnement et l‚Äôinstallation d‚ÄôAWX sur un cluster Kubernetes.

4. **Aptitudes en scripting et en gestion des mises √† jour**
Une bonne capacit√© √† √©crire et comprendre des scripts en Bash, PowerShell ou Python sera un atout consid√©rable pour personnaliser et adapter les processus d‚Äôautomatisation. De plus, une compr√©hension des enjeux li√©s aux mises √† jour de s√©curit√© et √† la gestion des vuln√©rabilit√©s est essentielle pour assurer un patch management efficace et conforme aux exigences des entreprises.

### Un Accompagnement Progressif pour Assurer une Mont√©e en Comp√©tences
Ce bootcamp est con√ßu pour accompagner les participants, quel que soit leur niveau initial, avec une mise √† niveau progressive sur les comp√©tences fondamentales en d√©but de formation. Ainsi, m√™me si certaines notions restent floues au d√©part, le programme permet d‚Äôacqu√©rir rapidement les bases n√©cessaires avant d‚Äôaborder des sujets plus avanc√©s.

L‚Äôapproche p√©dagogique alterne cours th√©oriques, d√©monstrations pratiques, exercices encadr√©s et projets concrets, garantissant ainsi une assimilation progressive et efficace des comp√©tences. L‚Äôobjectif est que chaque participant puisse, √† l‚Äôissue du programme, mettre en ≈ìuvre de mani√®re autonome une infrastructure de patch management automatis√©e et √©volutive.

Ce bootcamp repr√©sente une opportunit√© unique pour les professionnels de l‚ÄôIT souhaitant d√©velopper leur expertise en automatisation, DevOps et gestion des mises √† jour √† grande √©chelle. La demande pour ces comp√©tences est en forte croissance, et cette formation vous positionnera comme un acteur cl√© dans l‚Äôadministration et la s√©curisation des infrastructures modernes.

## Programme du Bootcamp

Ce programme intensif de trois mois est con√ßu pour les administrateurs syst√®mes souhaitant ma√Ætriser l'automatisation du patch management dans des environnements Linux et Windows. Il couvre Proxmox, Docker, Gitea, Kubernetes, Ansible et AWX, permettant aux participants de mettre en place un syst√®me automatis√© de gestion des mises √† jour.

Chaque √©tudiant b√©n√©ficie de 12 heures de coaching personnalis√© r√©parties sur trois mois (4 heures par mois), garantissant un suivi rigoureux et un accompagnement technique structur√©.

### Mois 1 : Mise en place de l‚Äôinfrastructure et des outils fondamentaux
Ce premier mois est consacr√© √† l‚Äôinstallation et la configuration des outils de virtualisation et de gestion des conteneurs, qui constitueront la base du projet.

#### Semaine 1 ‚Äì Installation et configuration de Proxmox
üìñ **Chapitres √† suivre** :
- Installation et mise √† jour de Proxmox
  - 2.1 Installation de Proxmox (5 min)
  - 2.2 Correction installation de Proxmox (15 min)
  - 2.3 Mise √† jour de Proxmox (10 min)
  - 2.5 D√©couverte de l‚Äôinterface d‚Äôadministration (15 min)
- Configuration r√©seau minimale pour les VMs
  - 3.1 Le r√©seau de type bridge (10 min)

üõ† **Exercice pratique** :
- Installer Proxmox sur un serveur ou une VM
- Configurer un r√©seau Bridge pour assurer la connectivit√© des VMs

#### Semaine 2 ‚Äì Cr√©ation et administration des machines virtuelles
üìñ **Chapitres √† suivre** :
- Cr√©ation des machines virtuelles Linux et Windows
  - 6.1 Cr√©er une machine virtuelle sur Proxmox (3 min)
  - 6.2 Cr√©er une machine virtuelle avec KVM (22 min)
- Gestion du stockage des VMs
  - 4.1 Les volumes LVM (Volume Group - VG) (18 min)
  - 4.2 LVM Thin : gestion avanc√©e du stockage (12 min)

üõ† **Exercice pratique** :
- Cr√©er les machines virtuelles suivantes :
  - VM Linux pour AWX
  - VM Linux pour le r√©f√©rentiel de patchs
  - VM Linux pour Gitea (installer docker et d√©ploie Gitea avec docker-compose)
  - VMS Windows pour tester le patch management

üìç **Bonus** : Authentification et snapshots (si n√©cessaire)
- Int√©gration avec Active Directory (pour AWX & Windows)
  - 5.3 Connecter un Active Directory √† Proxmox (11 min)
- Gestion des snapshots et sauvegarde
  - 9.5 Gestion des snapshots (8 min)

üõ† **Exercice pratique** :
- Cr√©er des snapshots avant l‚Äôinstallation d‚ÄôAWX et Gitea

#### Semaine 3 ‚Äì Administration syst√®me sous Linux et Windows Server
üìñ **Chapitres √† suivre** :
https://teachmemore.fr/courses/administrer-ubuntu/
https://teachmemore.fr/courses/windows-server-lessentiel/

- **Administration Linux**
  - 2.1 D√©couvrir le shell de Linux (7 min)
  - 2.2 Les diff√©rents r√©pertoires racines (18 min)
  - 2.3 Les commandes de base de Linux (20 min)
  - 2.5 Commandes "LS, MKDIR, CD, PWD" (31 min)
  - 2.6 Commandes "LN, CAT, LESS, MORE" (23 min)
  - 2.7 Rechercher des fichiers avec FIND (16 min)
  - 2.9 Rechercher des cha√Ænes avec GREP (7 min)
  - 2.14 Gestion des permissions avec CHMOD (17 min)

**Exercice** : Cr√©er le r√©f√©rentiel de d√©p√¥t Linux pour stocker les binaires et les paques !

- **Installation et configuration de Windows Server**
  - Installation de Windows Server (13 min)
  - Explication du r√¥le d‚Äôun contr√¥leur de domaine (7 min)
  - Installation et configuration d‚ÄôActive Directory
  - Cr√©ation et gestion des unit√©s organisationnelles et groupes (7 min)
  - Creation des utilisateurs

üõ† **Exercice pratique** :
- Manipulation des commandes Linux essentielles sur un serveur Ubuntu
- Installation et configuration d‚Äôun contr√¥leur de domaine Windows
- Connexion d‚Äôune machine Windows au domaine Active Directory

#### Semaine 4 ‚Äì Conteneurisation avec Docker et gestion du code avec Gitea
üìñ **Chapitres √† suivre** :
https://teachmemore.fr/courses/docker-lessentiel-pour-les-sysadmin-et-reseaux/

- **Introduction √† Docker**
  - C'est quoi Docker ? (27 min)
  - Installer Docker (10 min)
- **Gestion des conteneurs et stockage**
  - Manipuler les images Docker (14 min)
  - Cr√©er et g√©rer des conteneurs (26 min + 6 min)
  - Supprimer des conteneurs (6 min)
  - Manipuler les volumes (34 min)
- **Docker Compose et gestion avanc√©e**
  - Explication de Docker Compose (11 min)
  - D√©ploiement d'une application avec Docker Compose (35 min)
- **Gitea et gestion du code**
  - Installation de Gitea sur Docker
  - Cr√©ation et gestion des d√©p√¥ts Git

üõ† **Exercice pratique** :
- D√©ployer un serveur Gitea avec Docker Compose
- Cr√©er un d√©p√¥t Git et versionner les playbooks Ansible

### Mois 2 : Automatisation avec Ansible et AWX (ansible pour les r√©seaux et ansible pour Linux)
Ce deuxi√®me mois se concentre sur la mise en place de l‚Äôautomatisation des patchs avec Ansible et AWX.

**Introduction √† Kubernetes**.
https://teachmemore.fr/courses/kubernetes-2023-formation-complete-pour-devops-admins/
Reviser la partie 1 √† 7 sauf la partie 5 (Maxmimum 2 √† 3 semaines)

#### Semaine 5 ‚Äì Introduction √† Ansible et installation d‚ÄôAWX
R√©viser tous ce cours : https://teachmemore.fr/courses/ansible-pour-les-administrateurs-systemes-linux/ (deux semaines)

üõ† **Exercice pratique** :
- Installer AWX avec Kubernetes
- Ex√©cuter un premier playbook Ansible

#### Semaine 6 ‚Äì Gestion des inventaires et int√©gration avec Gitea
üìñ **Chapitres √† suivre** :
- Cr√©ation et gestion des inventaires sous AWX
- Synchronisation des playbooks avec Gitea
- Gestion des droits et utilisateurs sous AWX

üõ† **Exercice pratique** :
- Configurer un inventaire dynamique des √©quipements r√©seau
- Cr√©ation de Job Templates sous AWX
- Automatisation des mises √† jour des routeurs et des switchs y compris des configurations
- Ex√©cution des workflows d‚Äôautomatisation
- D√©ploiement des patchs automatis√©s sur plusieurs machines
- S√©curisation des communications avec HTTPS et certificats TLS (traefik pour reverse proxy)
- Int√©gration d‚ÄôActive Directory avec AWX

üõ† **Exercice pratique** :
- Configurer l‚Äôauthentification AD-DS sous AWX

### Mois 3 : Validation du projet et perfectionnement
- **Semaine 9** ‚Äì Optimisation des workflows et gestion avanc√©e des correctifs
- **Semaine 10** ‚Äì R√©solution des probl√®mes et tests avanc√©s
- **Semaine 11** ‚Äì Finalisation du projet et int√©gration des comp√©tences
- **Semaine 12** ‚Äì Soutenance et validation du projet

üìå **Objectif final** : D√©ployer une infrastructure compl√®te int√©grant Proxmox, AWX, Kubernetes et Gitea pour automatiser la gestion des correctifs sur un parc de machines Linux et Windows. üöÄ
